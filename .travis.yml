#-- Choose build environment
virt: lxd               # LXD container
os: linux
dist: focal             # Use Ubuntu 20
language: shell


#-- Choose which branches are built
branches:
  only:
    - master
    - develop

#-- Enable support services
services:
  - docker

#-- Dependencies
install:
  # install any dependencies required
  make deps


stages:
  - name: build
  - name: deploy
    if: branch = master


jobs:
  include:
    - stage: build
      install: make deps
      script: make docker-build

    - stage: deploy
      script: echo "this is the deploy stages"


# #-- Build script
# script:
#   # run the build script
#   - make
#   - make test
#
# after_success:
