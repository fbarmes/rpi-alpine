#-- Choose build environment
virt: lxd               # LXD container
os: linux
dist: focal             # Use Ubuntu 20
language: shell


#-- Choose which branches are built
branches:
  only:
    - master
    - develop

#-- Enable support services
services:
  - docker

#-- Dependencies
install:
  # install any dependencies required
  skip


#--
script:
  - make docker-build

#--
after_success:
  - if [[ "$TRAVIS_BRANCH" == "master" ]]; then
      echo "branch is ${TRAVIS_BRANCH} : push image"
      make docker-push docker-push-latest;
    else
      echo "branch is ${TRAVIS_BRANCH} : skip pushing image"
    fi
